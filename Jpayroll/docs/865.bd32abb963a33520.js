"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[865],{865:(P,g,h)=>{h.r(g),h.d(g,{default:()=>v});var r=h(9417),c=h(5974),C=h(7651),p=h(1626),t=h(4438),e=h(8064),s=h(1165),b=h(177);function _(l,w){1&l&&(t.j41(0,"div",27),t.EFF(1," Please provide a valid email "),t.k0s())}function f(l,w){1&l&&(t.j41(0,"div",27),t.EFF(1," Please provide OTP "),t.k0s())}function y(l,w){1&l&&(t.j41(0,"div",27),t.EFF(1," Please provide New Password "),t.k0s())}function k(l,w){1&l&&(t.j41(0,"div",27),t.EFF(1," Password Mismatched "),t.k0s())}let v=(()=>{class l{togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}encryptToBase64(a){return btoa(a)}constructor(a,d,n,i){this.fb=a,this.userService=d,this.http=n,this.router=i,this.showPassword=!1,this.showConfirmPassword=!1,this.ChangePassword=this.fb.group({Email:["",[r.k0.required,r.k0.email]],OTP:["",r.k0.required],Password:["",r.k0.required],ConfirmPassword:["",r.k0.required]},{validators:this.passwordsMatchValidator})}sendOTP(){const a=this.ChangePassword.get("Email")?.value;console.log("Sending email:",a),a?((new URLSearchParams).set("email",a),new p.Lr({"Content-Type":"application/x-www-form-urlencoded"}),this.http.post("http://localhost:3000/send-otp",{email:a}).subscribe(o=>{"success"===o.status?(alert(`OTP sent to ${a}`),this.otp=o.otp,console.log(this.otp)):alert(o.message)},o=>{console.error("Error sending OTP:",o),alert("Failed to send OTP. Please try again.")})):alert("Please enter a valid email address.")}ngOnInit(){const a=JSON.parse(localStorage.getItem("currentUser")||"{}");this.UserId=a.UserId}passwordsMatchValidator(a){const d=a.get("Password"),n=a.get("ConfirmPassword");n.setErrors(d&&n&&d.value!==n.value?{passwordsMismatch:!0}:null)}onSubmit(){if(this.ChangePassword.valid){if(this.ChangePassword.get("OTP")?.value!=this.otp)return void alert("Invalid OTP. Please enter the correct OTP.");const d={email:this.ChangePassword.get("Email")?.value,newPassword:this.ChangePassword.get("Password")?.value};console.log(d),this.userService.forgotPassword(d).subscribe(n=>{"success"===n.status?(this.router.navigate(["/Login"]),alert(n.message)):"error"===n.status&&alert(n.message)},n=>{console.error("Error:",n),alert("An error occurred while processing your request.")})}else alert("Form is invalid")}onLogin(){this.router.navigate(["/login"],{})}static{this.\u0275fac=function(d){return new(d||l)(t.rXU(r.ok),t.rXU(e.D),t.rXU(p.Qq),t.rXU(s.Ix))}}static{this.\u0275cmp=t.VBU({type:l,selectors:[["app-forgot-password-form"]],standalone:!0,features:[t.aNF],decls:46,vars:13,consts:[[1,"d-flex","justify-content-center","align-items-center","vh-100"],[1,"container",2,"max-width","400px"],[1,"text-center","mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","Email",1,"form-label"],["id","Email","formControlName","Email","type","email",1,"form-control"],["class","text-danger small",4,"ngIf"],["type","button",1,"btn","btn-secondary","w-100","mb-3",3,"click"],["for","OTP",1,"form-label"],["id","OTP","formControlName","OTP","type","number",1,"form-control"],[1,"row","mb-3"],[1,"col-sm-6"],["for","Password",1,"form-label"],[1,"input-group"],["formControlName","Password","id","Password","placeholder","Password",1,"form-control",3,"ngModelChange","type","ngModel"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["for","ConfirmPassword",1,"form-label"],["formControlName","ConfirmPassword","id","ConfirmPassword","placeholder","ConfirmPassword",1,"form-control",3,"ngModelChange","type","ngModel"],["type","submit",1,"btn","btn-primary","w-100"],[1,"mt-2"],[1,"btn","btn-primary","w-100",3,"click"],[1,"auth-footer","row"],[1,"col","my-1"],[1,"m-0"],["href","https://codedthemes.com/","target","_blank"],["rel","stylesheet","href",t.wXG`https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css`],[1,"text-danger","small"]],template:function(d,n){if(1&d&&(t.j41(0,"div",0)(1,"div",1)(2,"h1",2),t.EFF(3,"Forgot Password"),t.k0s(),t.j41(4,"form",3),t.bIt("ngSubmit",function(){return n.onSubmit()}),t.j41(5,"div",4)(6,"label",5),t.EFF(7,"Email"),t.k0s(),t.nrm(8,"input",6),t.DNE(9,_,2,0,"div",7),t.k0s(),t.j41(10,"button",8),t.bIt("click",function(){return n.sendOTP()}),t.EFF(11,"Send OTP"),t.k0s(),t.j41(12,"div",4)(13,"label",9),t.EFF(14,"OTP"),t.k0s(),t.nrm(15,"input",10),t.DNE(16,f,2,0,"div",7),t.k0s(),t.j41(17,"div",11)(18,"div",12)(19,"label",13),t.EFF(20,"New Password"),t.k0s(),t.j41(21,"div",14)(22,"input",15),t.mxI("ngModelChange",function(o){return t.DH7(n.Password,o)||(n.Password=o),o}),t.k0s(),t.j41(23,"button",16),t.bIt("click",function(){return n.togglePasswordVisibility()}),t.nrm(24,"i"),t.k0s()(),t.DNE(25,y,2,0,"div",7),t.k0s(),t.j41(26,"div",12)(27,"label",17),t.EFF(28,"Confirm Password"),t.k0s(),t.j41(29,"div",14)(30,"input",18),t.mxI("ngModelChange",function(o){return t.DH7(n.ConfirmPassword,o)||(n.ConfirmPassword=o),o}),t.k0s(),t.j41(31,"button",16),t.bIt("click",function(){return n.toggleConfirmPasswordVisibility()}),t.nrm(32,"i"),t.k0s()(),t.DNE(33,k,2,0,"div",7),t.k0s()(),t.j41(34,"button",19),t.EFF(35,"Submit"),t.k0s()(),t.j41(36,"div",20)(37,"button",21),t.bIt("click",function(){return n.onLogin()}),t.EFF(38,"Back To Login"),t.k0s()(),t.j41(39,"div",22)(40,"div",23)(41,"p",24),t.EFF(42," Copyright \xa9 "),t.j41(43,"a",25),t.EFF(44,"Jpayroll"),t.k0s()()()()()(),t.nrm(45,"link",26)),2&d){let i,o,u,m;t.R7$(4),t.Y8G("formGroup",n.ChangePassword),t.R7$(5),t.Y8G("ngIf",(null==(i=n.ChangePassword.get("Email"))?null:i.invalid)&&(null==(i=n.ChangePassword.get("Email"))?null:i.touched)),t.R7$(7),t.Y8G("ngIf",(null==(o=n.ChangePassword.get("OTP"))?null:o.invalid)&&(null==(o=n.ChangePassword.get("OTP"))?null:o.touched)),t.R7$(6),t.Y8G("type",n.showPassword?"text":"password"),t.R50("ngModel",n.Password),t.R7$(2),t.HbH(n.showPassword?"bi bi-eye-slash":"bi bi-eye"),t.R7$(),t.Y8G("ngIf",(null==(u=n.ChangePassword.get("Password"))?null:u.invalid)&&(null==(u=n.ChangePassword.get("Password"))?null:u.touched)),t.R7$(5),t.Y8G("type",n.showConfirmPassword?"text":"password"),t.R50("ngModel",n.ConfirmPassword),t.R7$(2),t.HbH(n.showConfirmPassword?"bi bi-eye-slash":"bi bi-eye"),t.R7$(),t.Y8G("ngIf",(null==(m=n.ChangePassword.get("ConfirmPassword"))?null:m.invalid)&&(null==(m=n.ChangePassword.get("ConfirmPassword"))?null:m.touched))}},dependencies:[c.ae,r.YN,r.qT,r.me,r.Q0,r.BC,r.cb,C.G,b.bT,r.j4,r.JD,p.q1]})}}return l})()},8064:(P,g,h)=>{h.d(g,{D:()=>C});var r=h(1626),c=h(4438);let C=(()=>{class p{constructor(e){this.http=e,this.GetChangeOrderDetails="backend/GetChangeOrderDetails.php",this.clientsUrl="backend/getClients.php",this.employeesUrl="backend/getEmployees.php",this.changeorderurl="backend/getChangeOrder.php",this.getStatusProgressUrl="backend/GetStatusProgress.php",this.getClientChangeOrders="backend/GetChangeOrderByClientId.php",this.getChangeLogDataByChangeOrder="backend/GetChangeLogDataByChangeOrder.php",this.GetChanageLogById="backend/GetChangeLogById.php",this.getClientbyClientID="backend/GetClientByClientID.php",this.getUsers="backend/GetUser.php",this.getUsersByUserId="backend/GetUserByUserId.php",this.recentchangeorderlog="backend/GetRecentChangeOrderLog.php",this.GetProvince="backend/GetProvince.php",this.GetCountry="backend/GetCountry.php",this.GetCity="backend/GetCity.php",this.GetDistrict="backend/GetDistrict.php",this.GetSubDistrict="backend/GetSubDistrict.php",this.insertchangeorder="backend/InsertChangeOrder.php",this.InsertChangeLog="backend/InsertChangeLog.php",this.insertClient="backend/InsertClient.php",this.InsertUser="backend/InsertUser.php",this.updatechangeorder="backend/UpdateChangeOrder.php",this.updatepassword="backend/ChangePassword.php",this.forgotpassword="backend/ForgotPassword.php",this.UpdateUser="backend/UpdateUser.php",this.updatechangelog="backend/UpdateChangeLogByID.php",this.updateclient="backend/updateClient.php",this.FileUpload="backend/upload.php",this.FileUploadtoDatabase="backend/uploadfiletodatabase.php",this.sendotp="backend/otp/SendOtp.php",this.logincred="backend/LoginCred.php",this.setInactive="backend/SetInactiveDateUser.php",this.deleteChangeOrder="backend/DeleteChangeOrder.php",this.deleteChangeLog="backend/DeleteChangeLog.php"}getRecentChangeOrderLog(){return this.http.get(this.recentchangeorderlog)}getChangeOrder(){return this.http.get(this.changeorderurl)}getChangeOrderDetails(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.GetChangeOrderDetails,{ChangeOrder:e},{headers:s})}GetUsers(){return this.http.get(this.getUsers)}insertUser(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.InsertUser,e,{headers:s})}Updatepassword(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.updatepassword,e,{headers:s})}forgotPassword(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.forgotpassword,e,{headers:s})}updateUser(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.UpdateUser,e,{headers:s})}GetUserByUserId(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.getUsersByUserId,{UserID:e},{headers:s})}SetInactive(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.setInactive,e,{headers:s})}getClients(){return this.http.get(this.clientsUrl)}getChangeClient(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.getClientChangeOrders,{clientId:e},{headers:s})}getclientByClientID(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.getClientbyClientID,{clientId:e},{headers:s})}getProvince(){return this.http.get(this.GetProvince)}getCountry(){return this.http.get(this.GetCountry)}getCity(){return this.http.get(this.GetCity)}getDistrict(){return this.http.get(this.GetDistrict)}getSubDistrict(){return this.http.get(this.GetSubDistrict)}getEmployees(){return this.http.get(this.employeesUrl)}getStatusProgress(){return this.http.get(this.getStatusProgressUrl)}GetChangeLogDataByChangeOrder(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.getChangeLogDataByChangeOrder,{ChangeOrder:e},{headers:s})}getchangelogbyId(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.GetChanageLogById,{ChangeLogId:e},{headers:s})}uploadFile(e){return this.http.post(this.FileUpload,e)}insertChangeLog(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.InsertChangeLog,e,{headers:s})}insertChangeRequest(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.insertchangeorder,e,{headers:s})}InsertClient(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.insertClient,e,{headers:s})}UpdateChangeOrder(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.updatechangeorder,e,{headers:s})}UpdateChangeLog(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.updatechangelog,e,{headers:s})}UpdateClient(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.updateclient,e,{headers:s})}DeleteChangeOrder(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.deleteChangeOrder,e,{headers:s})}DeleteChangeLog(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.deleteChangeLog,e,{headers:s})}LoginCred(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.logincred,e,{headers:s})}sendOtpToEmail(e){const s=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.sendotp,e,{headers:s})}uploadFiletodatabase(e){return this.http.post(this.FileUploadtoDatabase,e)}getUser(){return this.user}setUser(e){this.user=e}static{this.\u0275fac=function(s){return new(s||p)(c.KVO(r.Qq))}}static{this.\u0275prov=c.jDH({token:p,factory:p.\u0275fac,providedIn:"root"})}}return p})()}}]);