"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[828],{8064:(m,u,l)=>{l.d(u,{D:()=>g});var r=l(1626),_=l(4438);let g=(()=>{class e{constructor(n){this.http=n,this.GetChangeOrderDetails="backend/GetChangeOrderDetails.php",this.clientsUrl="backend/getClients.php",this.employeesUrl="backend/getEmployees.php",this.changeorderurl="backend/getChangeOrder.php",this.getStatusProgressUrl="backend/GetStatusProgress.php",this.getClientChangeOrders="backend/GetChangeOrderByClientId.php",this.getChangeLogDataByChangeOrder="backend/GetChangeLogDataByChangeOrder.php",this.GetChanageLogById="backend/GetChangeLogById.php",this.getClientbyClientID="backend/GetClientByClientID.php",this.getUsers="backend/GetUser.php",this.getUsersByUserId="backend/GetUserByUserId.php",this.recentchangeorderlog="backend/GetRecentChangeOrderLog.php",this.GetProvince="backend/GetProvince.php",this.GetCountry="backend/GetCountry.php",this.GetCity="backend/GetCity.php",this.GetDistrict="backend/GetDistrict.php",this.GetSubDistrict="backend/GetSubDistrict.php",this.insertchangeorder="backend/InsertChangeOrder.php",this.InsertChangeLog="backend/InsertChangeLog.php",this.insertClient="backend/InsertClient.php",this.InsertUser="backend/InsertUser.php",this.updatechangeorder="backend/UpdateChangeOrder.php",this.updatepassword="backend/ChangePassword.php",this.forgotpassword="backend/ForgotPassword.php",this.UpdateUser="backend/UpdateUser.php",this.updatechangelog="backend/UpdateChangeLogByID.php",this.updateclient="backend/updateClient.php",this.FileUpload="backend/upload.php",this.FileUploadtoDatabase="backend/uploadfiletodatabase.php",this.sendotp="backend/otp/SendOtp.php",this.logincred="backend/LoginCred.php",this.setInactive="backend/SetInactiveDateUser.php",this.deleteChangeOrder="backend/DeleteChangeOrder.php",this.deleteChangeLog="backend/DeleteChangeLog.php"}getRecentChangeOrderLog(){return this.http.get(this.recentchangeorderlog)}getChangeOrder(){return this.http.get(this.changeorderurl)}getChangeOrderDetails(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.GetChangeOrderDetails,{ChangeOrder:n},{headers:a})}GetUsers(){return this.http.get(this.getUsers)}insertUser(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.InsertUser,n,{headers:a})}Updatepassword(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.updatepassword,n,{headers:a})}forgotPassword(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.forgotpassword,n,{headers:a})}updateUser(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.UpdateUser,n,{headers:a})}GetUserByUserId(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.getUsersByUserId,{UserID:n},{headers:a})}SetInactive(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.setInactive,n,{headers:a})}getClients(){return this.http.get(this.clientsUrl)}getChangeClient(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.getClientChangeOrders,{clientId:n},{headers:a})}getclientByClientID(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.getClientbyClientID,{clientId:n},{headers:a})}getProvince(){return this.http.get(this.GetProvince)}getCountry(){return this.http.get(this.GetCountry)}getCity(){return this.http.get(this.GetCity)}getDistrict(){return this.http.get(this.GetDistrict)}getSubDistrict(){return this.http.get(this.GetSubDistrict)}getEmployees(){return this.http.get(this.employeesUrl)}getStatusProgress(){return this.http.get(this.getStatusProgressUrl)}GetChangeLogDataByChangeOrder(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.getChangeLogDataByChangeOrder,{ChangeOrder:n},{headers:a})}getchangelogbyId(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.GetChanageLogById,{ChangeLogId:n},{headers:a})}uploadFile(n){return this.http.post(this.FileUpload,n)}insertChangeLog(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.InsertChangeLog,n,{headers:a})}insertChangeRequest(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.insertchangeorder,n,{headers:a})}InsertClient(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.insertClient,n,{headers:a})}UpdateChangeOrder(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.updatechangeorder,n,{headers:a})}UpdateChangeLog(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.updatechangelog,n,{headers:a})}UpdateClient(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.updateclient,n,{headers:a})}DeleteChangeOrder(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.deleteChangeOrder,n,{headers:a})}DeleteChangeLog(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.deleteChangeLog,n,{headers:a})}LoginCred(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.logincred,n,{headers:a})}sendOtpToEmail(n){const a=new r.Lr({"Content-Type":"application/json"});return this.http.post(this.sendotp,n,{headers:a})}uploadFiletodatabase(n){return this.http.post(this.FileUploadtoDatabase,n)}getUser(){return this.user}setUser(n){this.user=n}static{this.\u0275fac=function(a){return new(a||e)(_.KVO(r.Qq))}}static{this.\u0275prov=_.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})()},5828:(m,u,l)=>{l.r(u),l.d(u,{DefaultComponent:()=>E});var r=l(177),_=l(7651),g=l(8167),e=l(4438),f=l(5788),n=l(8064),a=l(1165),d=l(9417),b=l(3413),C=l(3380);const D=(o,h)=>({top:o,left:h});function w(o,h){if(1&o&&(e.j41(0,"div",1)(1,"app-card",25)(2,"h6",26),e.EFF(3),e.k0s(),e.j41(4,"h4",3),e.EFF(5),e.k0s()()()),2&o){const t=h.$implicit;e.R7$(),e.Y8G("showHeader",!1),e.R7$(2),e.JRh(t.title),e.R7$(2),e.SpI(" ",t.amount," ")}}function y(o,h){if(1&o){const t=e.RV6();e.j41(0,"div",27),e.bIt("contextmenu",function(s){const c=e.eBV(t).row,p=e.XpG();return e.Njj(p.onContextMenu(s,c))}),e.EFF(1),e.k0s()}if(2&o){const t=h.value,i=h.row,s=e.XpG();e.Y8G("ngClass",s.getStatusClass(t)),e.R7$(),e.SpI(" ",i.ChangeOrder," ")}}function R(o,h){if(1&o){const t=e.RV6();e.j41(0,"div",27),e.bIt("contextmenu",function(s){const c=e.eBV(t).row,p=e.XpG();return e.Njj(p.onContextMenu(s,c))}),e.EFF(1),e.k0s()}if(2&o){const t=h.value,i=h.row,s=e.XpG();e.Y8G("ngClass",s.getStatusClass(t)),e.R7$(),e.SpI(" ",i.ClientName," ")}}function v(o,h){if(1&o){const t=e.RV6();e.j41(0,"div",27),e.bIt("contextmenu",function(s){const c=e.eBV(t).row,p=e.XpG();return e.Njj(p.onContextMenu(s,c))}),e.EFF(1),e.k0s()}if(2&o){const t=h.value,i=h.row,s=e.XpG();e.Y8G("ngClass",s.getStatusClass(t)),e.R7$(),e.SpI(" ",i.StatusProgress," ")}}function k(o,h){if(1&o){const t=e.RV6();e.j41(0,"li",30),e.bIt("click",function(){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onChangeLogClick(s.selectedRow.ChangeOrder,s.selectedRow.ClientName))}),e.EFF(1,"Change Log"),e.k0s()}}function O(o,h){if(1&o){const t=e.RV6();e.j41(0,"div",28)(1,"ul",29)(2,"li",30),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.openChangeDetail(s.selectedRow.ChangeOrder))}),e.EFF(3,"Open"),e.k0s(),e.DNE(4,k,2,0,"li",31),e.k0s()()}if(2&o){const t=e.XpG();e.Y8G("ngStyle",e.l_i(2,D,t.contextMenuPosition.y+"px",t.contextMenuPosition.x+"px")),e.R7$(4),e.Y8G("ngIf",1==t.currentUserType)}}function I(o,h){if(1&o&&(e.j41(0,"option",32),e.EFF(1),e.k0s()),2&o){const t=h.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function P(o,h){if(1&o&&(e.j41(0,"a",24)(1,"div",33),e.nrm(2,"div",34),e.j41(3,"div",35)(4,"h6",36),e.EFF(5),e.k0s(),e.j41(6,"p",37),e.EFF(7),e.nI1(8,"date"),e.k0s()(),e.j41(9,"div",38)(10,"h6",36),e.EFF(11),e.k0s(),e.j41(12,"p",37),e.EFF(13),e.k0s()()()()),2&o){const t=h.$implicit;e.R7$(5),e.SpI("Change Order: ",t.ChangeOrder,""),e.R7$(2),e.JRh(e.i5U(8,4,t.ChangeDate,"dd MMMM yyyy HH.mm")),e.R7$(4),e.SpI("Action: ",t.Altered,""),e.R7$(2),e.SpI("User: ",t.UserName,"")}}let E=(()=>{class o{constructor(t,i,s){this.iconService=t,this.dataService=i,this.router=s,this.contextMenuVisible=!1,this.contextMenuPosition={x:0,y:0},this.Progress=[],this.transaction=[],this.columns=[{prop:"ChangeOrder",name:"Change Order"},{prop:"ClientName",name:"Company Name"},{prop:"StatusProgress",name:"Status"}],this.rows=[],this.pageSize=5,this.pageSizes=[5,10,15,20,25,30,35],this.page={offset:0},this.paginatedRows=[],this.filteredRows=[],this.searchTerm="",this.iconService.addIcon(g.QCV,g.aRQ,g.Blt,g.HiO,g.c2)}getStatusClass(t){switch(t){case"On Pending":return"status-pending";case"On Progress":return"status-progress";case"Completed":return"status-completed";default:return""}}ngOnInit(){this.fetchData(),this.fetchProgress(),this.fetchRecentChangeOrder();const t=JSON.parse(localStorage.getItem("crud")||"{}");this.currentUserType=t}fetchProgress(){this.dataService.getStatusProgress().subscribe(t=>{this.Progress=t},t=>{console.error("Error fetching clients",t)})}fetchRecentChangeOrder(){this.dataService.getRecentChangeOrderLog().subscribe(t=>{this.transaction=t},t=>{console.error("Error fetching recent transactions:",t)})}fetchData(){this.dataService.getChangeOrder().subscribe(t=>{this.rows=t,this.filteredRows=[...this.rows],this.paginatedRows=this.getPaginatedRows()},t=>{console.error("Error fetching data",t)})}onPage(t){this.page.offset=t.offset,this.paginatedRows=this.getPaginatedRows()}onPreviousPage(){this.page.offset>0&&(this.page.offset--,this.paginatedRows=this.getPaginatedRows())}onNextPage(){this.page.offset<Math.ceil(this.filteredRows.length/this.pageSize)-1&&(this.page.offset++,this.paginatedRows=this.getPaginatedRows())}onPageSizeChange(t){this.page.offset=0,this.pageSize=Number(t.target.value),this.paginatedRows=this.getPaginatedRows()}getPaginatedRows(){const t=this.page.offset*this.pageSize;return this.filteredRows.slice(t,t+this.pageSize)}isLastPage(){return this.page.offset>=Math.ceil(this.filteredRows.length/this.pageSize)-1}onSearch(){const t=this.searchTerm.toLowerCase();this.filteredRows=this.rows.filter(i=>i.ClientName.toLowerCase().includes(t)||i.StatusProgress.toLowerCase().includes(t)||i.ChangeOrder.toLowerCase().includes(t)),this.page.offset=0,this.paginatedRows=this.getPaginatedRows()}onContextMenu(t,i){t.preventDefault(),this.contextMenuVisible=!0,this.contextMenuPosition={x:t.clientX,y:t.clientY},this.selectedRow=i}openChangeDetail(t){this.router.navigate(["/ChangeDetails"],{state:{changeOrder:t}})}onChangeLogClick(t,i){this.router.navigate(["/ChangeLog"],{state:{changeOrder:t,company:i}})}closeContextMenu(){this.contextMenuVisible=!1}static{this.\u0275fac=function(i){return new(i||o)(e.rXU(f.fM),e.rXU(n.D),e.rXU(a.Ix))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-default"]],hostBindings:function(i,s){1&i&&e.bIt("click",function(){return s.closeContextMenu()},!1,e.EBC)},standalone:!0,features:[e.aNF],decls:37,vars:16,consts:[[1,"row"],[1,"col-md-6","col-xl-4"],[1,"col-md-12","col-xl-8"],[1,"mb-3"],[1,"mb-3","d-flex","justify-content-between"],["type","text","placeholder","Search...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"card","tbl-card"],[1,"material","rounded-lg","border","border-gray-300",3,"page","rows","columns","columnMode","headerHeight","rowHeight","limit","count","offset"],["name","Change Order","prop","ChangeOrder"],["ngx-datatable-cell-template",""],["name","Company Name","prop","ClientName"],["name","Status","prop","StatusProgress",3,"cellClass"],["class","context-menu bg-white shadow-lg rounded-lg p-2 absolute z-10",3,"ngStyle",4,"ngIf"],[1,"d-flex","justify-content-between","mt-3","p-3"],[1,"mb-2"],[1,"text-sm","text-black"],[1,"border","border-gray-300","rounded-lg","p-1",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"text-sm","text-black","mt-3"],[1,"btn","btn-secondary","me-3",3,"click","disabled"],[1,"btn","btn-primary",3,"click","disabled"],[1,"col-md-12","col-xl-4"],[1,"card"],[1,"list-group","list-group-flush"],["href","javascript:",1,"list-group-item","list-group-item-action","px-3"],["blockClass","dashboard-card",3,"showHeader"],[1,"mb-2","f-w-400","text-muted"],[3,"contextmenu","ngClass"],[1,"context-menu","bg-white","shadow-lg","rounded-lg","p-2","absolute","z-10",3,"ngStyle"],[1,"list-none","p-0","m-0"],[1,"cursor-pointer","p-2","hover:bg-gray-200",3,"click"],["class","cursor-pointer p-2 hover:bg-gray-200",3,"click",4,"ngIf"],[3,"value"],[1,"d-flex"],[1,"flex-shrink-0"],[1,"flex-grow-1","ms-3"],[1,"mb-1"],[1,"mb-0","text-muted"],[1,"flex-shrink-0","text-end"]],template:function(i,s){1&i&&(e.j41(0,"div",0),e.Z7z(1,w,6,3,"div",1,e.fX1),e.j41(3,"div",2)(4,"h5",3),e.EFF(5,"Recent Orders"),e.k0s(),e.j41(6,"div",4)(7,"input",5),e.mxI("ngModelChange",function(p){return e.DH7(s.searchTerm,p)||(s.searchTerm=p),p}),e.bIt("input",function(){return s.onSearch()}),e.k0s()(),e.j41(8,"div",6)(9,"ngx-datatable",7),e.bIt("page",function(p){return s.onPage(p)}),e.j41(10,"ngx-datatable-column",8),e.DNE(11,y,2,2,"ng-template",9),e.k0s(),e.j41(12,"ngx-datatable-column",10),e.DNE(13,R,2,2,"ng-template",9),e.k0s(),e.j41(14,"ngx-datatable-column",11),e.DNE(15,v,2,2,"ng-template",9),e.k0s()(),e.DNE(16,O,5,5,"div",12),e.j41(17,"div",13)(18,"div",14)(19,"p",15),e.EFF(20,"Showing"),e.k0s(),e.j41(21,"select",16),e.mxI("ngModelChange",function(p){return e.DH7(s.pageSize,p)||(s.pageSize=p),p}),e.bIt("change",function(p){return s.onPageSizeChange(p)}),e.DNE(22,I,2,2,"option",17),e.k0s(),e.j41(23,"p",18),e.EFF(24),e.k0s()(),e.j41(25,"div")(26,"button",19),e.bIt("click",function(){return s.onPreviousPage()}),e.EFF(27," Previous "),e.k0s(),e.j41(28,"button",20),e.bIt("click",function(){return s.onNextPage()}),e.EFF(29," Next "),e.k0s()()()()(),e.j41(30,"div",21)(31,"h5",3),e.EFF(32,"Change Order History"),e.k0s(),e.j41(33,"div",22)(34,"div",23),e.Z7z(35,P,14,7,"a",24,e.fX1),e.k0s()()()()),2&i&&(e.R7$(),e.Dyx(s.Progress),e.R7$(6),e.R50("ngModel",s.searchTerm),e.R7$(2),e.Y8G("rows",s.paginatedRows)("columns",s.columns)("columnMode","force")("headerHeight",50)("rowHeight","auto")("limit",s.pageSize)("count",s.filteredRows.length)("offset",s.page.offset),e.R7$(5),e.Y8G("cellClass",s.getStatusClass),e.R7$(2),e.Y8G("ngIf",s.contextMenuVisible),e.R7$(5),e.R50("ngModel",s.pageSize),e.R7$(),e.Y8G("ngForOf",s.pageSizes),e.R7$(2),e.SpI("of ",s.filteredRows.length," records"),e.R7$(2),e.Y8G("disabled",0===s.page.offset),e.R7$(2),e.Y8G("disabled",s.isLastPage()),e.R7$(7),e.Dyx(s.transaction))},dependencies:[r.MD,r.YU,r.Sq,r.bT,r.B3,r.vh,_.G,d.xH,d.y7,d.me,d.wz,d.BC,d.vS,b.i,C.ge,C.ed,C.QI],styles:[".card{background-color:#fafafa}.card .card-body.dashboard-card{padding:18px 18px 20px}.user-group img{position:relative;width:35px;height:35px;border-radius:50%;z-index:2;transition:all .1s ease-in-out;border:2px solid var(--bs-white)}.user-group img+img{margin-left:-14px}.user-group img:hover{z-index:5}.badge-circle{display:inline-block;width:8px;height:8px;border-radius:50%}\n"],encapsulation:2})}}return o})()}}]);