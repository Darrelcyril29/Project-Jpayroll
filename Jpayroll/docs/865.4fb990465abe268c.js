"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[865],{865:(w,l,h)=>{h.r(l),h.d(l,{default:()=>O});var n=h(4341),g=h(5974),m=h(2389),d=h(1626),t=h(4438),e=h(8064),s=h(6256),b=h(177);function _(p,P){1&p&&(t.j41(0,"div",24),t.EFF(1," Please provide a valid email "),t.k0s())}function f(p,P){1&p&&(t.j41(0,"div",24),t.EFF(1," Please provide OTP "),t.k0s())}function y(p,P){1&p&&(t.j41(0,"div",24),t.EFF(1," Please provide New Password "),t.k0s())}function v(p,P){1&p&&(t.j41(0,"div",24),t.EFF(1," Password Mismatched "),t.k0s())}let O=(()=>{class p{encryptToBase64(o){return btoa(o)}constructor(o,a,r,i){this.fb=o,this.userService=a,this.http=r,this.router=i,this.ChangePassword=this.fb.group({Email:["",[n.k0.required,n.k0.email]],OTP:["",n.k0.required],Password:["",n.k0.required],ConfirmPassword:["",n.k0.required]},{validators:this.passwordsMatchValidator})}sendOTP(){const o=this.ChangePassword.get("Email")?.value;if(console.log("Sending email:",o),o){const a=new URLSearchParams;a.set("email",o);const r=new d.Lr({"Content-Type":"application/x-www-form-urlencoded"});this.http.post("backend/otp/SendOtp.php",a.toString(),{headers:r}).subscribe(i=>{"success"===i.status?(alert(`OTP sent to ${o}`),this.otp=i.otp,console.log(this.otp)):alert(i.message)},i=>{console.error("Error sending OTP:",i),alert("Failed to send OTP. Please try again.")})}else alert("Please enter a valid email address.")}ngOnInit(){const o=JSON.parse(localStorage.getItem("currentUser")||"{}");this.UserId=o.UserId}passwordsMatchValidator(o){const a=o.get("Password"),r=o.get("ConfirmPassword");r.setErrors(a&&r&&a.value!==r.value?{passwordsMismatch:!0}:null)}onSubmit(){if(this.ChangePassword.valid){if(this.ChangePassword.get("OTP")?.value!=this.otp)return void alert("Invalid OTP. Please enter the correct OTP.");const a={email:this.ChangePassword.get("Email")?.value,newPassword:this.ChangePassword.get("Password")?.value};console.log(a),this.userService.forgotPassword(a).subscribe(r=>{("success"===r.status||"error"===r.status)&&alert(r.message)},r=>{console.error("Error:",r),alert("An error occurred while processing your request.")})}else alert("Form is invalid")}onLogin(){this.router.navigate(["/login"],{})}static{this.\u0275fac=function(a){return new(a||p)(t.rXU(n.ok),t.rXU(e.D),t.rXU(d.Qq),t.rXU(s.Ix))}}static{this.\u0275cmp=t.VBU({type:p,selectors:[["app-forgot-password-form"]],standalone:!0,features:[t.aNF],decls:39,vars:5,consts:[[1,"d-flex","justify-content-center","align-items-center","vh-100"],[1,"container",2,"max-width","400px"],[1,"text-center","mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","Email",1,"form-label"],["id","Email","formControlName","Email","type","email",1,"form-control"],["class","text-danger small",4,"ngIf"],["type","button",1,"btn","btn-secondary","w-100","mb-3",3,"click"],["for","OTP",1,"form-label"],["id","OTP","formControlName","OTP","type","number",1,"form-control"],[1,"row","mb-3"],[1,"col-sm-6"],["for","Password",1,"form-label"],["id","Password","formControlName","Password","type","password",1,"form-control"],["for","ConfirmPassword",1,"form-label"],["id","ConfirmPassword","formControlName","ConfirmPassword","type","password",1,"form-control"],["type","submit",1,"btn","btn-primary","w-100"],[1,"mt-2"],[1,"btn","btn-primary","w-100",3,"click"],[1,"auth-footer","row"],[1,"col","my-1"],[1,"m-0"],["href","https://codedthemes.com/","target","_blank"],[1,"text-danger","small"]],template:function(a,r){if(1&a&&(t.j41(0,"div",0)(1,"div",1)(2,"h1",2),t.EFF(3,"Forgot Password"),t.k0s(),t.j41(4,"form",3),t.bIt("ngSubmit",function(){return r.onSubmit()}),t.j41(5,"div",4)(6,"label",5),t.EFF(7,"Email"),t.k0s(),t.nrm(8,"input",6),t.DNE(9,_,2,0,"div",7),t.k0s(),t.j41(10,"button",8),t.bIt("click",function(){return r.sendOTP()}),t.EFF(11,"Send OTP"),t.k0s(),t.j41(12,"div",4)(13,"label",9),t.EFF(14,"OTP"),t.k0s(),t.nrm(15,"input",10),t.DNE(16,f,2,0,"div",7),t.k0s(),t.j41(17,"div",11)(18,"div",12)(19,"label",13),t.EFF(20,"New Password"),t.k0s(),t.nrm(21,"input",14),t.DNE(22,y,2,0,"div",7),t.k0s(),t.j41(23,"div",12)(24,"label",15),t.EFF(25,"Confirm Password"),t.k0s(),t.nrm(26,"input",16),t.DNE(27,v,2,0,"div",7),t.k0s()(),t.j41(28,"button",17),t.EFF(29,"Submit"),t.k0s()(),t.j41(30,"div",18)(31,"button",19),t.bIt("click",function(){return r.onLogin()}),t.EFF(32,"Back To Login"),t.k0s()(),t.j41(33,"div",20)(34,"div",21)(35,"p",22),t.EFF(36," Copyright \xa9 "),t.j41(37,"a",23),t.EFF(38,"Jpayroll"),t.k0s()()()()()()),2&a){let i,c,u,C;t.R7$(4),t.Y8G("formGroup",r.ChangePassword),t.R7$(5),t.Y8G("ngIf",(null==(i=r.ChangePassword.get("Email"))?null:i.invalid)&&(null==(i=r.ChangePassword.get("Email"))?null:i.touched)),t.R7$(7),t.Y8G("ngIf",(null==(c=r.ChangePassword.get("OTP"))?null:c.invalid)&&(null==(c=r.ChangePassword.get("OTP"))?null:c.touched)),t.R7$(6),t.Y8G("ngIf",(null==(u=r.ChangePassword.get("Password"))?null:u.invalid)&&(null==(u=r.ChangePassword.get("Password"))?null:u.touched)),t.R7$(5),t.Y8G("ngIf",(null==(C=r.ChangePassword.get("ConfirmPassword"))?null:C.invalid)&&(null==(C=r.ChangePassword.get("ConfirmPassword"))?null:C.touched))}},dependencies:[g.ae,n.YN,n.qT,n.me,n.Q0,n.BC,n.cb,m.G,b.bT,n.j4,n.JD,d.q1]})}}return p})()},8064:(w,l,h)=>{h.d(l,{D:()=>m});var n=h(1626),g=h(4438);let m=(()=>{class d{constructor(e){this.http=e,this.GetChangeOrderDetails="backend/GetChangeOrderDetails.php",this.clientsUrl="backend/getClients.php",this.employeesUrl="backend/getEmployees.php",this.changeorderurl="backend/getChangeOrder.php",this.getStatusProgressUrl="backend/GetStatusProgress.php",this.getClientChangeOrders="backend/GetChangeOrderByClientId.php",this.getChangeLogDataByChangeOrder="backend/GetChangeLogDataByChangeOrder.php",this.GetChanageLogById="backend/GetChangeLogById.php",this.getClientbyClientID="backend/GetClientByClientID.php",this.getUsers="backend/GetUser.php",this.getUsersByUserId="backend/GetUserByUserId.php",this.recentchangeorderlog="backend/GetRecentChangeOrderLog.php",this.GetProvince="backend/GetProvince.php",this.GetCountry="backend/GetCountry.php",this.GetCity="backend/GetCity.php",this.GetDistrict="backend/GetDistrict.php",this.GetSubDistrict="backend/GetSubDistrict.php",this.insertchangeorder="backend/InsertChangeOrder.php",this.InsertChangeLog="backend/InsertChangeLog.php",this.insertClient="backend/InsertClient.php",this.InsertUser="backend/InsertUser.php",this.updatechangeorder="backend/UpdateChangeOrder.php",this.updatepassword="backend/ChangePassword.php",this.forgotpassword="backend/ForgotPassword.php",this.UpdateUser="backend/UpdateUser.php",this.updatechangelog="backend/UpdateChangeLogByID.php",this.updateclient="backend/updateClient.php",this.FileUpload="backend/upload.php",this.FileUploadtoDatabase="backend/uploadfiletodatabase.php",this.sendotp="backend/otp/SendOtp.php",this.logincred="backend/LoginCred.php",this.setInactive="backend/SetInactiveDateUser.php",this.deleteChangeOrder="backend/DeleteChangeOrder.php",this.deleteChangeLog="backend/DeleteChangeLog.php"}getRecentChangeOrderLog(){return this.http.get(this.recentchangeorderlog)}getChangeOrder(){return this.http.get(this.changeorderurl)}getChangeOrderDetails(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.GetChangeOrderDetails,{ChangeOrder:e},{headers:s})}GetUsers(){return this.http.get(this.getUsers)}insertUser(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.InsertUser,e,{headers:s})}Updatepassword(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.updatepassword,e,{headers:s})}forgotPassword(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.forgotpassword,e,{headers:s})}updateUser(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.UpdateUser,e,{headers:s})}GetUserByUserId(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.getUsersByUserId,{UserID:e},{headers:s})}SetInactive(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.setInactive,e,{headers:s})}getClients(){return this.http.get(this.clientsUrl)}getChangeClient(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.getClientChangeOrders,{clientId:e},{headers:s})}getclientByClientID(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.getClientbyClientID,{clientId:e},{headers:s})}getProvince(){return this.http.get(this.GetProvince)}getCountry(){return this.http.get(this.GetCountry)}getCity(){return this.http.get(this.GetCity)}getDistrict(){return this.http.get(this.GetDistrict)}getSubDistrict(){return this.http.get(this.GetSubDistrict)}getEmployees(){return this.http.get(this.employeesUrl)}getStatusProgress(){return this.http.get(this.getStatusProgressUrl)}GetChangeLogDataByChangeOrder(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.getChangeLogDataByChangeOrder,{ChangeOrder:e},{headers:s})}getchangelogbyId(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.GetChanageLogById,{ChangeLogId:e},{headers:s})}uploadFile(e){return this.http.post(this.FileUpload,e)}insertChangeLog(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.InsertChangeLog,e,{headers:s})}insertChangeRequest(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.insertchangeorder,e,{headers:s})}InsertClient(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.insertClient,e,{headers:s})}UpdateChangeOrder(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.updatechangeorder,e,{headers:s})}UpdateChangeLog(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.updatechangelog,e,{headers:s})}UpdateClient(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.updateclient,e,{headers:s})}DeleteChangeOrder(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.deleteChangeOrder,e,{headers:s})}DeleteChangeLog(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.deleteChangeLog,e,{headers:s})}LoginCred(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.logincred,e,{headers:s})}sendOtpToEmail(e){const s=new n.Lr({"Content-Type":"application/json"});return this.http.post(this.sendotp,e,{headers:s})}uploadFiletodatabase(e){return this.http.post(this.FileUploadtoDatabase,e)}getUser(){return this.user}setUser(e){this.user=e}static{this.\u0275fac=function(s){return new(s||d)(g.KVO(n.Qq))}}static{this.\u0275prov=g.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}}return d})()}}]);