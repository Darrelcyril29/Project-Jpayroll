"use strict";(self.webpackChunkmantis_free_version=self.webpackChunkmantis_free_version||[]).push([[447],{8064:(C,d,g)=>{g.d(d,{D:()=>_});var p=g(1626),e=g(4438);let _=(()=>{class l{constructor(s){this.http=s,this.GetChangeOrderDetails="backend/GetChangeOrderDetails.php",this.clientsUrl="backend/getClients.php",this.employeesUrl="backend/getEmployees.php",this.changeorderurl="backend/getChangeOrder.php",this.getStatusProgressUrl="backend/GetStatusProgress.php",this.getClientChangeOrders="backend/GetChangeOrderByClientId.php",this.getChangeLogDataByChangeOrder="backend/GetChangeLogDataByChangeOrder.php",this.GetChanageLogById="backend/GetChangeLogById.php",this.getClientbyClientID="backend/GetClientByClientID.php",this.getUsers="backend/GetUser.php",this.getUsersByUserId="backend/GetUserByUserId.php",this.recentchangeorderlog="backend/GetRecentChangeOrderLog.php",this.GetProvince="backend/GetProvince.php",this.GetCountry="backend/GetCountry.php",this.GetCity="backend/GetCity.php",this.GetDistrict="backend/GetDistrict.php",this.GetSubDistrict="backend/GetSubDistrict.php",this.insertchangeorder="backend/InsertChangeOrder.php",this.InsertChangeLog="backend/InsertChangeLog.php",this.insertClient="backend/InsertClient.php",this.InsertUser="backend/InsertUser.php",this.updatechangeorder="backend/UpdateChangeOrder.php",this.updatepassword="backend/ChangePassword.php",this.forgotpassword="backend/ForgotPassword.php",this.UpdateUser="backend/UpdateUser.php",this.updatechangelog="backend/UpdateChangeLogByID.php",this.updateclient="backend/updateClient.php",this.FileUpload="backend/upload.php",this.FileUploadtoDatabase="backend/uploadfiletodatabase.php",this.sendotp="backend/otp/SendOtp.php",this.logincred="backend/LoginCred.php",this.setInactive="backend/SetInactiveDateUser.php",this.deleteChangeOrder="backend/DeleteChangeOrder.php",this.deleteChangeLog="backend/DeleteChangeLog.php"}getRecentChangeOrderLog(){return this.http.get(this.recentchangeorderlog)}getChangeOrder(){return this.http.get(this.changeorderurl)}getChangeOrderDetails(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.GetChangeOrderDetails,{ChangeOrder:s},{headers:r})}GetUsers(){return this.http.get(this.getUsers)}insertUser(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.InsertUser,s,{headers:r})}Updatepassword(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.updatepassword,s,{headers:r})}forgotPassword(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.forgotpassword,s,{headers:r})}updateUser(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.UpdateUser,s,{headers:r})}GetUserByUserId(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.getUsersByUserId,{UserID:s},{headers:r})}SetInactive(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.setInactive,s,{headers:r})}getClients(){return this.http.get(this.clientsUrl)}getChangeClient(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.getClientChangeOrders,{clientId:s},{headers:r})}getclientByClientID(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.getClientbyClientID,{clientId:s},{headers:r})}getProvince(){return this.http.get(this.GetProvince)}getCountry(){return this.http.get(this.GetCountry)}getCity(){return this.http.get(this.GetCity)}getDistrict(){return this.http.get(this.GetDistrict)}getSubDistrict(){return this.http.get(this.GetSubDistrict)}getEmployees(){return this.http.get(this.employeesUrl)}getStatusProgress(){return this.http.get(this.getStatusProgressUrl)}GetChangeLogDataByChangeOrder(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.getChangeLogDataByChangeOrder,{ChangeOrder:s},{headers:r})}getchangelogbyId(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.GetChanageLogById,{ChangeLogId:s},{headers:r})}uploadFile(s){return this.http.post(this.FileUpload,s)}insertChangeLog(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.InsertChangeLog,s,{headers:r})}insertChangeRequest(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.insertchangeorder,s,{headers:r})}InsertClient(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.insertClient,s,{headers:r})}UpdateChangeOrder(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.updatechangeorder,s,{headers:r})}UpdateChangeLog(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.updatechangelog,s,{headers:r})}UpdateClient(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.updateclient,s,{headers:r})}DeleteChangeOrder(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.deleteChangeOrder,s,{headers:r})}DeleteChangeLog(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.deleteChangeLog,s,{headers:r})}LoginCred(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.logincred,s,{headers:r})}sendOtpToEmail(s){const r=new p.Lr({"Content-Type":"application/json"});return this.http.post(this.sendotp,s,{headers:r})}uploadFiletodatabase(s){return this.http.post(this.FileUploadtoDatabase,s)}getUser(){return this.user}setUser(s){this.user=s}static{this.\u0275fac=function(r){return new(r||l)(e.KVO(p.Qq))}}static{this.\u0275prov=e.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})()},8828:(C,d,g)=>{g.r(d),g.d(d,{default:()=>L});var p=g(7651),e=g(4438),_=g(8064),l=g(1165),u=g(177),s=g(9417),r=g(3380),m=g(8834);const f=(a,c)=>({top:a,left:c});function b(a,c){if(1&a){const t=e.RV6();e.j41(0,"a",24),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onAdd())}),e.j41(1,"button",25),e.EFF(2,"Add"),e.k0s()()}}function w(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",26),e.bIt("contextmenu",function(n){const i=e.eBV(t).row,h=e.XpG();return e.Njj(h.onContextMenu(n,i))}),e.EFF(1),e.k0s()}if(2&a){const t=c.row;e.R7$(),e.SpI(" ",t.ClientName," ")}}function O(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",26),e.bIt("contextmenu",function(n){const i=e.eBV(t).row,h=e.XpG();return e.Njj(h.onContextMenu(n,i))}),e.EFF(1),e.k0s()}if(2&a){const t=c.row;e.R7$(),e.SpI(" ",t.ChangeOrder," ")}}function k(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",26),e.bIt("contextmenu",function(n){const i=e.eBV(t).row,h=e.XpG();return e.Njj(h.onContextMenu(n,i))}),e.EFF(1),e.k0s()}if(2&a){const t=c.row;e.R7$(),e.SpI(" ",t.RefNumber," ")}}function y(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",26),e.bIt("contextmenu",function(n){const i=e.eBV(t).row,h=e.XpG();return e.Njj(h.onContextMenu(n,i))}),e.EFF(1),e.k0s()}if(2&a){const t=c.row;e.R7$(),e.SpI(" ",t.ChangeType," ")}}function R(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",27),e.bIt("contextmenu",function(n){const i=e.eBV(t).row,h=e.XpG();return e.Njj(h.onContextMenu(n,i))}),e.EFF(1),e.k0s()}if(2&a){const t=c.value,o=c.row,n=e.XpG();e.Y8G("ngClass",n.getStatusClass(t)),e.R7$(),e.SpI(" ",o.StatusProgress," ")}}function T(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",26),e.bIt("contextmenu",function(n){const i=e.eBV(t).row,h=e.XpG();return e.Njj(h.onContextMenu(n,i))}),e.j41(1,"button",28),e.bIt("click",function(){const n=e.eBV(t).row,i=e.XpG();return e.Njj(i.openChangeDetail(n.ChangeOrder))}),e.nrm(2,"span",29),e.k0s(),e.j41(3,"button",28),e.bIt("click",function(){const n=e.eBV(t).row,i=e.XpG();return e.Njj(i.onChangeLogClick(n.ChangeOrder,n.ClientName,n.RefNumber,n.ChangeType))}),e.nrm(4,"span",30),e.k0s()()}}function j(a,c){if(1&a){const t=e.RV6();e.j41(0,"li",33),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.onChangeLogClick(n.selectedRow.ChangeOrder,n.selectedRow.ClientName,n.selectedRow.RefNumber,n.selectedRow.ChangeType))}),e.EFF(1,"Change Log"),e.k0s()}}function I(a,c){if(1&a){const t=e.RV6();e.j41(0,"div",31)(1,"ul",32)(2,"li",33),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.openChangeDetail(n.selectedRow.ChangeOrder))}),e.EFF(3,"Open"),e.k0s(),e.DNE(4,j,2,0,"li",34),e.k0s()()}if(2&a){const t=e.XpG();e.Y8G("ngStyle",e.l_i(2,f,t.contextMenuPosition.y+"px",t.contextMenuPosition.x+"px")),e.R7$(4),e.Y8G("ngIf",1==t.currentUserType)}}function D(a,c){if(1&a&&(e.j41(0,"option",35),e.EFF(1),e.k0s()),2&a){const t=c.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}let L=(()=>{class a{getStatusClass(t){switch(t){case"On Pending":return"status-pending";case"On Progress":return"status-progress";case"Completed":return"status-completed";default:return""}}constructor(t,o){this.dataService=t,this.router=o,this.rows=[],this.pageSize=5,this.pageSizes=[5,10,15,20,25,30,35],this.page={offset:0},this.paginatedRows=[],this.filteredRows=[],this.searchTerm="",this.contextMenuVisible=!1,this.contextMenuPosition={x:0,y:0}}ngOnInit(){this.fetchData();const t=JSON.parse(localStorage.getItem("crud")||"{}");this.currentUserType=t}fetchData(){this.dataService.getChangeOrder().subscribe(t=>{this.rows=t,this.filteredRows=[...this.rows],this.paginatedRows=this.getPaginatedRows()},t=>{console.error("Error fetching data",t)})}onPage(t){this.page.offset=t.offset,this.paginatedRows=this.getPaginatedRows()}onPreviousPage(){this.page.offset>0&&(this.page.offset--,this.paginatedRows=this.getPaginatedRows())}onNextPage(){this.page.offset<Math.ceil(this.filteredRows.length/this.pageSize)-1&&(this.page.offset++,this.paginatedRows=this.getPaginatedRows())}onPageSizeChange(t){this.page.offset=0,this.pageSize=Number(t.target.value),this.paginatedRows=this.getPaginatedRows()}getPaginatedRows(){const t=this.page.offset*this.pageSize;return this.filteredRows.slice(t,t+this.pageSize)}isLastPage(){return this.page.offset>=Math.ceil(this.filteredRows.length/this.pageSize)-1}onRowClick(t){if("click"===t.type){const o=t.row;console.log("Row clicked:",o),alert(`You clicked on ${o.ChangeOrder}`)}}onSearch(){const t=this.searchTerm.toLowerCase();this.filteredRows=this.rows.filter(o=>o.ClientName.toLowerCase().includes(t)||o.StatusProgress.toLowerCase().includes(t)||o.ChangeType.toLowerCase().includes(t)||o.ChangeOrder.toLowerCase().includes(t)||o.RefNumber.toLowerCase().includes(t)),this.page.offset=0,this.paginatedRows=this.getPaginatedRows()}onContextMenu(t,o){t.preventDefault(),this.contextMenuVisible=!0,this.contextMenuPosition={x:t.clientX,y:t.clientY},this.selectedRow=o}openChangeDetail(t){this.router.navigate(["/ChangeDetails"],{state:{changeOrder:t}})}onChangeLogClick(t,o,n,i){this.router.navigate(["/ChangeLog"],{state:{changeOrder:t,company:o,refno:n,changeType:i}})}onAdd(){this.router.navigate(["/ChangeForm"],{})}closeContextMenu(){this.contextMenuVisible=!1}static{this.\u0275fac=function(o){return new(o||a)(e.rXU(_.D),e.rXU(l.Ix))}}static{this.\u0275cmp=e.VBU({type:a,selectors:[["app-change-order"]],hostBindings:function(o,n){1&o&&e.bIt("click",function(){return n.closeContextMenu()},!1,e.EBC)},standalone:!0,features:[e.aNF],decls:35,vars:16,consts:[[1,"p-5"],[1,"mb-5","text-left"],[1,"text-l","font-bold","text-gray-800"],[1,"mb-3","d-flex","justify-content-between"],["type","text","placeholder","Search...",1,"form-control",3,"ngModelChange","input","ngModel"],[3,"click",4,"ngIf"],[1,"material","rounded-lg","border","border-gray-300",3,"page","rows","columnMode","headerHeight","rowHeight","limit","count","offset"],["name","Company","prop","ClientName"],["ngx-datatable-cell-template",""],["name","Change Order","prop","ChangeOrder"],["name","Reference Number","prop","RefNumber"],["name","Change Type","prop","ChangeType"],["name","Status","prop","StatusProgress",3,"cellClass"],["name","Actions"],["class","context-menu bg-white shadow-lg rounded-lg p-2 absolute z-10",3,"ngStyle",4,"ngIf"],[1,"d-flex","justify-content-between","mt-3"],[1,"mb-2"],[1,"text-sm","text-black"],[1,"border","border-gray-300","rounded-lg","p-1",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"text-sm","text-black","mt-3"],[1,"btn","btn-secondary","me-3",3,"click","disabled"],[1,"btn","btn-primary",3,"click","disabled"],["href",e.wXG`https://cdn.syncfusion.com/ej2/ej2-icons/styles/bootstrap5.css`,"rel","stylesheet"],[3,"click"],[1,"btn","btn-primary","ms-2"],[3,"contextmenu"],[3,"contextmenu","ngClass"],["mat-icon-button","",3,"click"],[1,"e-icons","e-circle-info","e-large"],[1,"e-icons","e-clock","e-large"],[1,"context-menu","bg-white","shadow-lg","rounded-lg","p-2","absolute","z-10",3,"ngStyle"],[1,"list-none","p-0","m-0"],[1,"cursor-pointer","p-2","hover:bg-gray-200",3,"click"],["class","cursor-pointer p-2 hover:bg-gray-200",3,"click",4,"ngIf"],[3,"value"]],template:function(o,n){1&o&&(e.j41(0,"div",0)(1,"div",1)(2,"h1",2),e.EFF(3,"Change Order"),e.k0s()(),e.j41(4,"div",3)(5,"input",4),e.mxI("ngModelChange",function(h){return e.DH7(n.searchTerm,h)||(n.searchTerm=h),h}),e.bIt("input",function(){return n.onSearch()}),e.k0s(),e.DNE(6,b,3,0,"a",5),e.k0s(),e.j41(7,"ngx-datatable",6),e.bIt("page",function(h){return n.onPage(h)}),e.j41(8,"ngx-datatable-column",7),e.DNE(9,w,2,1,"ng-template",8),e.k0s(),e.j41(10,"ngx-datatable-column",9),e.DNE(11,O,2,1,"ng-template",8),e.k0s(),e.j41(12,"ngx-datatable-column",10),e.DNE(13,k,2,1,"ng-template",8),e.k0s(),e.j41(14,"ngx-datatable-column",11),e.DNE(15,y,2,1,"ng-template",8),e.k0s(),e.j41(16,"ngx-datatable-column",12),e.DNE(17,R,2,2,"ng-template",8),e.k0s(),e.j41(18,"ngx-datatable-column",13),e.DNE(19,T,5,0,"ng-template",8),e.k0s()(),e.DNE(20,I,5,5,"div",14),e.j41(21,"div",15)(22,"div",16)(23,"p",17),e.EFF(24,"Showing"),e.k0s(),e.j41(25,"select",18),e.mxI("ngModelChange",function(h){return e.DH7(n.pageSize,h)||(n.pageSize=h),h}),e.bIt("change",function(h){return n.onPageSizeChange(h)}),e.DNE(26,D,2,2,"option",19),e.k0s(),e.j41(27,"p",20),e.EFF(28),e.k0s()(),e.j41(29,"div")(30,"button",21),e.bIt("click",function(){return n.onPreviousPage()}),e.EFF(31," Previous "),e.k0s(),e.j41(32,"button",22),e.bIt("click",function(){return n.onNextPage()}),e.EFF(33," Next "),e.k0s()()()(),e.nrm(34,"link",23)),2&o&&(e.R7$(5),e.R50("ngModel",n.searchTerm),e.R7$(),e.Y8G("ngIf",1==n.currentUserType),e.R7$(),e.Y8G("rows",n.paginatedRows)("columnMode","force")("headerHeight",50)("rowHeight","auto")("limit",n.pageSize)("count",n.filteredRows.length)("offset",n.page.offset),e.R7$(9),e.Y8G("cellClass",n.getStatusClass),e.R7$(4),e.Y8G("ngIf",n.contextMenuVisible),e.R7$(5),e.R50("ngModel",n.pageSize),e.R7$(),e.Y8G("ngForOf",n.pageSizes),e.R7$(2),e.SpI("of ",n.filteredRows.length," records"),e.R7$(2),e.Y8G("disabled",0===n.page.offset),e.R7$(2),e.Y8G("disabled",n.isLastPage()))},dependencies:[p.G,u.YU,u.Sq,u.bT,u.B3,s.xH,s.y7,s.me,s.wz,s.BC,s.vS,r.ge,r.ed,r.QI,m.iY],encapsulation:2})}}return a})()}}]);